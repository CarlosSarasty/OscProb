\hypertarget{classOscProb_1_1PMNS__Sterile}{}\section{Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+Sterile Class Reference}
\label{classOscProb_1_1PMNS__Sterile}\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}


Implementation of oscillations of neutrinos in matter in a N-\/neutrino framework.  




{\ttfamily \#include $<$P\+M\+N\+S\+\_\+\+Sterile.\+h$>$}

Inheritance diagram for Osc\+Prob\+:\+:P\+M\+N\+S\+\_\+\+Sterile\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classOscProb_1_1PMNS__Sterile}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef std\+::complex$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classOscProb_1_1PMNS__Sterile_a774766ab4278d9369a295ffa8e2d272c}{P\+M\+N\+S\+\_\+\+Sterile} (int Num\+Nus)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
virtual \hyperlink{classOscProb_1_1PMNS__Sterile_a992eaf747da2c16f680060d48284c2b9}{$\sim$\+P\+M\+N\+S\+\_\+\+Sterile} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob} (int flvi, int flvf)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}{Prob} (int flvi, int flvf, double E)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}{Prob} (int flvi, int flvf, double E, double L)
\begin{DoxyCompactList}\small\item\em Compute the probability of flvi going to flvf for energy E and distance L. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}{Avg\+Prob} (int flvi, int flvf, double E, double dE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of energy. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}{Avg\+Prob\+LoE} (int flvi, int flvf, double LoE, double d\+LoE=0)
\begin{DoxyCompactList}\small\item\em Compute the average probability over a bin of L/E. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{Set\+Angle} (int i, int j, double th)
\begin{DoxyCompactList}\small\item\em Set the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}{Set\+Delta} (int i, int j, double delta)
\begin{DoxyCompactList}\small\item\em Set the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{Set\+Dm} (int j, double dm)
\begin{DoxyCompactList}\small\item\em Set the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}{Get\+Angle} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the mixing angle theta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}{Get\+Delta} (int i, int j)
\begin{DoxyCompactList}\small\item\em Get the CP phase delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}{Get\+Dm} (int j)
\begin{DoxyCompactList}\small\item\em Get the mass-\/splitting dm\+\_\+j1 in e\+V$^\wedge$2. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}{Set\+Std\+Pars} ()
\begin{DoxyCompactList}\small\item\em Set P\+DG 3-\/flavor parameters. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{Set\+Energy} (double E)
\begin{DoxyCompactList}\small\item\em Set the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}{Set\+Is\+Nu\+Bar} (bool is\+Nu\+Bar)
\begin{DoxyCompactList}\small\item\em Set the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}{Get\+Energy} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino energy in GeV. \end{DoxyCompactList}\item 
virtual bool \hyperlink{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}{Get\+Is\+Nu\+Bar} ()
\begin{DoxyCompactList}\small\item\em Get the anti-\/neutrino flag. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{Set\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}{Set\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Set a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}{Set\+Path} (std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ paths)
\begin{DoxyCompactList}\small\item\em Set a path sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{Add\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}{Add\+Path} (double length, double density, double zoa=0.\+5, int layer=0)
\begin{DoxyCompactList}\small\item\em Add a path to the sequence. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{Clear\+Path} ()
\begin{DoxyCompactList}\small\item\em Clear the path vector. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{Set\+Length} (double L)
\begin{DoxyCompactList}\small\item\em Set a single path lentgh in km. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}{Set\+Length} (std\+::vector$<$ double $>$ L)
\begin{DoxyCompactList}\small\item\em Set multiple path lengths. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}{Set\+Density} (double rho)
\begin{DoxyCompactList}\small\item\em Set single path density in g/cm$^\wedge$3. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}{Set\+Density} (std\+::vector$<$ double $>$ rho)
\begin{DoxyCompactList}\small\item\em Set multiple path densities. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}{Set\+ZoA} (double zoa)
\begin{DoxyCompactList}\small\item\em Set Z/A value for single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}{Set\+ZoA} (std\+::vector$<$ double $>$ zoa)
\begin{DoxyCompactList}\small\item\em Set multiple path Z/A values. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}{Set\+Layers} (std\+::vector$<$ int $>$ lay)
\begin{DoxyCompactList}\small\item\em Set multiple path layer indices. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{Set\+Std\+Path} ()
\begin{DoxyCompactList}\small\item\em Set standard neutrino path. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}{Get\+Path} ()
\begin{DoxyCompactList}\small\item\em Get the neutrino path sequence. \end{DoxyCompactList}\item 
virtual std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{Get\+Sample\+Points} (double LoE, double d\+LoE)
\begin{DoxyCompactList}\small\item\em Compute the sample points for a bin of L/E with width d\+LoE. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Sterile_af60f89862d0fe333c62d6f87ecfd89f8}{Solve\+Ham} ()
\begin{DoxyCompactList}\small\item\em Solve the full Hamiltonian for eigenvectors and eigenvalues. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}{Initialize\+Vectors} ()
\begin{DoxyCompactList}\small\item\em Initialize all member vectors with zeros. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{Set\+Cur\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Set the path currently in use by the class. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{Set\+Att} (double att, int idx)
\begin{DoxyCompactList}\small\item\em Set one of the path attributes. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}{Set\+Att} (std\+::vector$<$ double $>$ att, int idx)
\begin{DoxyCompactList}\small\item\em Set all values of a path attribute. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH} (int i, int j)
\begin{DoxyCompactList}\small\item\em Rotate the Hamiltonian by theta\+\_\+ij and delta\+\_\+ij. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{Build\+Hms} ()
\begin{DoxyCompactList}\small\item\em Build the matrix of masses squared. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{Reset\+To\+Flavour} (int flv)
\begin{DoxyCompactList}\small\item\em Reset neutrino state to pure flavour flv. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{Propagate\+Path} (\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} p)
\begin{DoxyCompactList}\small\item\em Propagate neutrino through a single path. \end{DoxyCompactList}\item 
virtual void \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate} ()
\begin{DoxyCompactList}\small\item\em Propagate neutrino through full path. \end{DoxyCompactList}\item 
virtual double \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{P} (int flv)
\begin{DoxyCompactList}\small\item\em Return the probability of final state in flavour flv. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
gsl\+\_\+vector $\ast$ \hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{f\+Eval\+G\+SL}
\begin{DoxyCompactList}\small\item\em Stores the G\+SL eigenvalues. \end{DoxyCompactList}\item 
gsl\+\_\+matrix\+\_\+complex $\ast$ \hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{f\+Evec\+G\+SL}
\begin{DoxyCompactList}\small\item\em Stores the G\+SL eigenvectors. \end{DoxyCompactList}\item 
gsl\+\_\+matrix\+\_\+complex $\ast$ \hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\+\_\+\+G\+SL}
\begin{DoxyCompactList}\small\item\em The Hamiltonian to be solved by G\+SL. \end{DoxyCompactList}\item 
gsl\+\_\+eigen\+\_\+hermv\+\_\+workspace $\ast$ \hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\+\_\+\+G\+SL}
\begin{DoxyCompactList}\small\item\em Allocates memory for G\+SL solution. \end{DoxyCompactList}\item 
int \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{f\+Num\+Nus}
\begin{DoxyCompactList}\small\item\em Number of neutrino flavours. \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{f\+Dm}
\begin{DoxyCompactList}\small\item\em m$^\wedge$2\+\_\+i -\/ m$^\wedge$2\+\_\+1 in vacuum \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{f\+Theta}
\begin{DoxyCompactList}\small\item\em theta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} mixing angle \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ double $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{f\+Delta}
\begin{DoxyCompactList}\small\item\em delta\mbox{[}i\mbox{]}\mbox{[}j\mbox{]} CP violating phase \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} $>$ \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{f\+Nu\+State}
\begin{DoxyCompactList}\small\item\em The neutrino current state. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{f\+Hms}
\begin{DoxyCompactList}\small\item\em matrix H$\ast$2E in e\+V$^\wedge$2 \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{f\+Eval}
\begin{DoxyCompactList}\small\item\em Eigenvalues of the Hamiltonian. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::vector$<$ \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} $>$ $>$ \hyperlink{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}{f\+Evec}
\begin{DoxyCompactList}\small\item\em Eigenvectors of the Hamiltonian. \end{DoxyCompactList}\item 
double \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{f\+Energy}
\begin{DoxyCompactList}\small\item\em Neutrino energy. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{f\+Is\+Nu\+Bar}
\begin{DoxyCompactList}\small\item\em Anti-\/neutrino flag. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$ \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{f\+Nu\+Paths}
\begin{DoxyCompactList}\small\item\em Vector of neutrino paths. \end{DoxyCompactList}\item 
\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{f\+Path}
\begin{DoxyCompactList}\small\item\em Current neutrino path. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{f\+Built\+Hms}
\begin{DoxyCompactList}\small\item\em Tag to avoid rebuilding Hms. \end{DoxyCompactList}\item 
bool \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{f\+Got\+ES}
\begin{DoxyCompactList}\small\item\em Tag to avoid recalculating eigensystem. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
static const \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} \hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero}
\begin{DoxyCompactList}\small\item\em zero in complex \end{DoxyCompactList}\item 
static const \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} \hyperlink{classOscProb_1_1PMNS__Base_ab64aab27448a5aca27565c991a9d173e}{one}
\begin{DoxyCompactList}\small\item\em one in complex \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{k\+Km2eV} = 1.\+0 / 1.\+973269788e-\/10
\begin{DoxyCompactList}\small\item\em km to e\+V$^\wedge$-\/1 \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{k\+K2} = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)
\begin{DoxyCompactList}\small\item\em mol/\+Ge\+V$^\wedge$2/cm$^\wedge$3 to eV \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{k\+Ge\+V2eV} = 1.\+0e+09
\begin{DoxyCompactList}\small\item\em GeV to eV. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}{k\+NA} = 6.\+022140857e23
\begin{DoxyCompactList}\small\item\em Avogadro constant. \end{DoxyCompactList}\item 
static const double \hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{k\+Gf} = 1.\+1663787e-\/05
\begin{DoxyCompactList}\small\item\em G\+\_\+F in units of Ge\+V$^\wedge$-\/2. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class implements neutrino oscillations for any number of neutrino falvours. The extra flavours above 3 are treated as sterile neutrinos, i.\+e. it implements a 3+N model. One can also run a 2-\/neutrino model in principle, but an analytical solution would be feasible and more efficient in that case.

The eigensystem solution is performed by G\+SL, which makes it slower than the \hyperlink{classOscProb_1_1PMNS__Fast}{P\+M\+N\+S\+\_\+\+Fast} class, which only works for 3 neutrinos.

\begin{DoxyAuthor}{Author}
coelho@lal.\+in2p3.\+fr 
\end{DoxyAuthor}


Definition at line 26 of file P\+M\+N\+S\+\_\+\+Sterile.\+h.



\subsection{Member Typedef Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}\label{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!complex@{complex}}
\index{complex@{complex}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{complex}{complex}}
{\footnotesize\ttfamily typedef std\+::complex$<$double$>$ \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::complex}\hspace{0.3cm}{\ttfamily [inherited]}}



Definition at line 105 of file P\+M\+N\+S\+\_\+\+Base.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_a774766ab4278d9369a295ffa8e2d272c}\label{classOscProb_1_1PMNS__Sterile_a774766ab4278d9369a295ffa8e2d272c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!P\+M\+N\+S\+\_\+\+Sterile@{P\+M\+N\+S\+\_\+\+Sterile}}
\index{P\+M\+N\+S\+\_\+\+Sterile@{P\+M\+N\+S\+\_\+\+Sterile}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{P\+M\+N\+S\+\_\+\+Sterile()}{PMNS\_Sterile()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+Sterile\+::\+P\+M\+N\+S\+\_\+\+Sterile (\begin{DoxyParamCaption}\item[{int}]{num\+Nus }\end{DoxyParamCaption})}

Constructor. \begin{DoxySeeAlso}{See also}
\hyperlink{classOscProb_1_1PMNS__Base_aa53e83b03a9cf4bdfa0a07136bd17a79}{P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base}
\end{DoxySeeAlso}
This class can implement any number of neutrino flavours.


\begin{DoxyParams}{Parameters}
{\em num\+Nus} & -\/ the number of neutrino flavours \\
\hline
\end{DoxyParams}


Definition at line 38 of file P\+M\+N\+S\+\_\+\+Sterile.\+cxx.



References f\+Eval\+G\+SL, f\+Evec\+G\+SL, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, H\+\_\+\+G\+SL, and W\+\_\+\+G\+SL.


\begin{DoxyCode}
38                                      : \hyperlink{classOscProb_1_1PMNS__Base_aa53e83b03a9cf4bdfa0a07136bd17a79}{PMNS\_Base}(numNus),
39 \hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL}(0), \hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL}(0), \hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}(0), \hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\_GSL}(0)
40 \{
41 
42   \textcolor{comment}{// Allocate memory for the GSL objects}
43   \hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL} = gsl\_vector\_alloc(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
44   \hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL} = gsl\_matrix\_complex\_alloc(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
45   \hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL} = gsl\_matrix\_complex\_alloc(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
46   \hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\_GSL} = gsl\_eigen\_hermv\_alloc(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
47 
48 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_a992eaf747da2c16f680060d48284c2b9}\label{classOscProb_1_1PMNS__Sterile_a992eaf747da2c16f680060d48284c2b9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!````~P\+M\+N\+S\+\_\+\+Sterile@{$\sim$\+P\+M\+N\+S\+\_\+\+Sterile}}
\index{````~P\+M\+N\+S\+\_\+\+Sterile@{$\sim$\+P\+M\+N\+S\+\_\+\+Sterile}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{$\sim$\+P\+M\+N\+S\+\_\+\+Sterile()}{~PMNS\_Sterile()}}
{\footnotesize\ttfamily P\+M\+N\+S\+\_\+\+Sterile\+::$\sim$\+P\+M\+N\+S\+\_\+\+Sterile (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Destructor.

Clear G\+SL objects. 

Definition at line 56 of file P\+M\+N\+S\+\_\+\+Sterile.\+cxx.



References f\+Eval\+G\+SL, f\+Evec\+G\+SL, H\+\_\+\+G\+SL, and W\+\_\+\+G\+SL.


\begin{DoxyCode}
56                            \{
57 
58   \textcolor{comment}{// Free memory from GSL objects}
59   gsl\_matrix\_complex\_free(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}); \hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL} = 0;
60   gsl\_eigen\_hermv\_free(\hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\_GSL}); \hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\_GSL} = 0;
61   gsl\_matrix\_complex\_free(\hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL}); \hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL} = 0;
62   gsl\_vector\_free(\hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL}); \hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL} = 0;
63 
64 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}\label{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence. 
\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 257 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
257                                \{
258 
259   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.push\_back(p);
260 
261 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}\label{classOscProb_1_1PMNS__Base_ab7f89ad9e7e1224adaa59d3c41594cd9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Add\+Path@{Add\+Path}}
\index{Add\+Path@{Add\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Add\+Path()}{AddPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Add a path to the sequence defining attributes directly. 
\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 271 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path().


\begin{DoxyCode}
271                                                                            \{
272 
273   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
274 
275 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}\label{classOscProb_1_1PMNS__Base_ac03f754160422e6600da8dbae0f803ed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Avg\+Prob@{Avg\+Prob}}
\index{Avg\+Prob@{Avg\+Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Avg\+Prob()}{AvgProb()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{dE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of energy E with width dE.

This gets transformed into L/E, since the oscillation terms have arguments linear in L/E and not E.

This function currently only works for single paths.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in the bin center in GeV \\
\hline
{\em dE} & -\/ The energy bin width in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1077 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path().


\begin{DoxyCode}
1078 \{
1079 
1080   \textcolor{comment}{// Do nothing if energy is not positive}
1081   \textcolor{keywordflow}{if}(E<=0) \textcolor{keywordflow}{return} 0;
1082 
1083   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1084 
1085   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() != 1)\{
1086     cout << \textcolor{stringliteral}{"ERROR: AvgProb not implemented for multiple paths."} << endl;
1087     cout << \textcolor{stringliteral}{"       Returning probability at bin center."} << endl;
1088     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, E);
1089   \}
1090 
1091   \textcolor{comment}{// Don't average zero width}
1092   \textcolor{keywordflow}{if}(dE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, E);
1093 
1094   \textcolor{comment}{// Make sure fPath is set}
1095   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0]);
1096 
1097   \textcolor{comment}{// Define L/E variables}
1098   \textcolor{keywordtype}{double} LoE = 0;
1099   \textcolor{keywordtype}{double} dLoE = 0;
1100 
1101   \textcolor{comment}{// Set a minimum energy}
1102   \textcolor{keywordtype}{double} minE = 0.1 * E;
1103 
1104   \textcolor{comment}{// Transform range to L/E}
1105   \textcolor{comment}{// Full range if low edge > minE}
1106   \textcolor{keywordflow}{if}(E-dE/2 > minE)\{
1107     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1108     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E-dE/2) - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1109   \}
1110   \textcolor{comment}{// Else start at minE}
1111   \textcolor{keywordflow}{else}\{
1112     LoE = 0.5 * (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE + \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2));
1113     dLoE = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/minE - \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/(E+dE/2);
1114   \}
1115 
1116   \textcolor{comment}{// Compute average in LoE}
1117   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}{AvgProbLoE}(flvi, flvf, LoE, dLoE);
1118 
1119 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}\label{classOscProb_1_1PMNS__Base_ac19a92f4ef428a7333ca8eed76fca637}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Avg\+Prob\+LoE@{Avg\+Prob\+LoE}}
\index{Avg\+Prob\+LoE@{Avg\+Prob\+LoE}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Avg\+Prob\+Lo\+E()}{AvgProbLoE()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+LoE (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{LoE,  }\item[{double}]{d\+LoE = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the average probability of flvi going to flvf over a bin of L/E with width d\+LoE.

The probabilities are weighted by (L/E)$^\wedge$-\/2 so that event density is flat in energy. This avoids giving too much weight to low energies. Better approximations would be achieved if we used an interpolated event density.

This function currently only works for single paths.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Average neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1145 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob().


\begin{DoxyCode}
1146 \{
1147 
1148   \textcolor{comment}{// Do nothing if L/E is not positive}
1149   \textcolor{keywordflow}{if}(LoE<=0) \textcolor{keywordflow}{return} 0;
1150 
1151   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.empty()) \textcolor{keywordflow}{return} 0;
1152 
1153   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() > 1)\{
1154 
1155     cout << \textcolor{stringliteral}{"ERROR: AvgProb not implemented for multiple paths."} << endl;
1156     cout << \textcolor{stringliteral}{"       Returning probability at bin center."} << endl;
1157 
1158     \textcolor{keywordtype}{double} L = 0;
1159     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<int(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size()); i++)\{
1160       L += \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].length;
1161     \}
1162 
1163     \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, L/LoE);
1164 
1165   \}
1166 
1167   \textcolor{comment}{// Make sure fPath is set}
1168   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0]);
1169 
1170   \textcolor{comment}{// Set the energy at bin center}
1171   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}/LoE);
1172 
1173   \textcolor{comment}{// Don't average zero width}
1174   \textcolor{keywordflow}{if}(dLoE<=0) \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1175 
1176   \textcolor{comment}{// Get sample points for this bin}
1177   vector<double> samples = \hyperlink{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}{GetSamplePoints}(LoE, dLoE);
1178 
1179   \textcolor{comment}{// Variables to fill sample}
1180   \textcolor{comment}{// probabilities and weights}
1181   \textcolor{keywordtype}{double} sumw = 0;
1182   \textcolor{keywordtype}{double} prob = 0;
1183 
1184   \textcolor{comment}{// Loop over all sample points}
1185   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(samples.size()); j++)\{
1186 
1187     \textcolor{comment}{// Set (L/E)^-2 weights}
1188     \textcolor{keywordtype}{double} w = 1./pow(samples[j],2);
1189 
1190     \textcolor{comment}{// Add weighted probability}
1191     prob += w * \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf, \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length} / samples[j]);
1192 
1193     \textcolor{comment}{// Increment sum of weights}
1194     sumw += w;
1195 
1196   \}
1197 
1198   \textcolor{comment}{// Return weighted average of probabilities}
1199   \textcolor{keywordflow}{return} prob / sumw;
1200 
1201 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}\label{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Build\+Hms@{Build\+Hms}}
\index{Build\+Hms@{Build\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Build\+Hms()}{BuildHms()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Build Hms = H$\ast$2E, where H is the Hamiltonian in vacuum on flavour basis and E is the neutrino energy in eV. Hms is effectively the matrix of masses squared.

This is a hermitian matrix, so only the upper triangular part needs to be filled

The construction of the Hamiltonian avoids computing terms that are simply zero. This has a big impact in the computation time. 

Definition at line 852 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H().



Referenced by Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().


\begin{DoxyCode}
853 \{
854 
855   \textcolor{comment}{// Check if anything changed}
856   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms}) \textcolor{keywordflow}{return};
857 
858   \textcolor{comment}{// Tag to recompute eigensystem}
859   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{false};
860 
861   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
862     \textcolor{comment}{// Set mass splitting}
863     \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] = \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j];
864     \textcolor{comment}{// Reset off-diagonal elements}
865     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
866       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] = 0;
867     \}
868     \textcolor{comment}{// Rotate j neutrinos}
869     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<j; i++)\{
870       \hyperlink{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}{RotateH}(i,j);
871     \}
872   \}
873 
874   \textcolor{comment}{// Tag as built}
875   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} = \textcolor{keyword}{true};
876 
877 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}\label{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Clear\+Path@{Clear\+Path}}
\index{Clear\+Path@{Clear\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Clear\+Path()}{ClearPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Clear the path vector. 

Definition at line 225 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
225                          \{
226 
227   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.clear();
228 
229 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}\label{classOscProb_1_1PMNS__Base_acee137091304c919642293ddf015bbc8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Angle@{Get\+Angle}}
\index{Get\+Angle@{Get\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Angle()}{GetAngle()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 564 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.


\begin{DoxyCode}
565 \{
566 
567   \textcolor{keywordflow}{if}(i>j)\{
568     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
569     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
570     \textcolor{keywordtype}{int} temp = i;
571     i = j;
572     j = temp;
573   \}
574   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
575     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
576     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
577     \textcolor{keywordflow}{return} 0;
578   \}
579 
580   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1];
581 
582 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}\label{classOscProb_1_1PMNS__Base_adb8dbc91d4286d2e7c8f768c59476241}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Delta@{Get\+Delta}}
\index{Get\+Delta@{Get\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Delta()}{GetDelta()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 634 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
635 \{
636 
637   \textcolor{keywordflow}{if}(i>j)\{
638     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
639     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
640     \textcolor{keywordtype}{int} temp = i;
641     i = j;
642     j = temp;
643   \}
644   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
645     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
646     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
647     \textcolor{keywordflow}{return} 0;
648   \}
649   \textcolor{keywordflow}{if}(i+1==j)\{
650     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Returning zero."} << endl;
651     \textcolor{keywordflow}{return} 0;
652   \}
653 
654   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1];
655 
656 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}\label{classOscProb_1_1PMNS__Base_ad26815ac5f4805d1259817e4936e5f8f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Dm@{Get\+Dm}}
\index{Get\+Dm@{Get\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Dm()}{GetDm()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm (\begin{DoxyParamCaption}\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 694 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.


\begin{DoxyCode}
695 \{
696 
697   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
698     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
699     cout << \textcolor{stringliteral}{" neutrinos. Returning zero."} << endl;
700     \textcolor{keywordflow}{return} 0;
701   \}
702 
703   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1];
704 
705 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}\label{classOscProb_1_1PMNS__Base_acc0d46cc4b8f911b40b807225003bbed}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Energy@{Get\+Energy}}
\index{Get\+Energy@{Get\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Energy()}{GetEnergy()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the neutrino energy in GeV. 

Definition at line 183 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy.


\begin{DoxyCode}
183                             \{
184 
185   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};
186 
187 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}\label{classOscProb_1_1PMNS__Base_a2f7f2a028dfe7a90fff6b4f757972c2c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}}
\index{Get\+Is\+Nu\+Bar@{Get\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Is\+Nu\+Bar()}{GetIsNuBar()}}
{\footnotesize\ttfamily bool P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the anti-\/neutrino flag. 

Definition at line 193 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.


\begin{DoxyCode}
193                            \{
194 
195   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar};
196 
197 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}\label{classOscProb_1_1PMNS__Base_ac8e196f2e85a2b1caaf705073ee95a5c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Path@{Get\+Path}}
\index{Get\+Path@{Get\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Path()}{GetPath()}}
{\footnotesize\ttfamily vector$<$ \hyperlink{structOscProb_1_1NuPath}{Nu\+Path} $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Get the vector of neutrino paths. 

Definition at line 246 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
246                                  \{
247 
248   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths};
249 
250 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}\label{classOscProb_1_1PMNS__Base_a9eac8d768c1424755ee41f7e783af179}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Get\+Sample\+Points@{Get\+Sample\+Points}}
\index{Get\+Sample\+Points@{Get\+Sample\+Points}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Get\+Sample\+Points()}{GetSamplePoints()}}
{\footnotesize\ttfamily vector$<$ double $>$ P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points (\begin{DoxyParamCaption}\item[{double}]{LoE,  }\item[{double}]{d\+LoE }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the sample points for a bin of L/E with width d\+LoE

This is used for averaging the probability over a bin of L/E. It should be a private function, but I\textquotesingle{}m keeping it public for now for debugging purposes. The number of sample points seems too high for most purposes. The number of subdivisions needs to be optimized.


\begin{DoxyParams}{Parameters}
{\em LoE} & -\/ The neutrino L/E value in the bin center in km/\+GeV \\
\hline
{\em d\+LoE} & -\/ The L/E bin width in km/\+GeV \\
\hline
\end{DoxyParams}


Definition at line 1216 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E().


\begin{DoxyCode}
1217 \{
1218 
1219   \textcolor{comment}{// Solve Hamiltonian to get eigenvalues}
1220   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
1221 
1222   \textcolor{comment}{// Define conversion factor [km/GeV -> 1/(4 eV^2)]}
1223   \textcolor{keyword}{const} \textcolor{keywordtype}{double} k1267 = \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} / (4 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV});
1224 
1225   \textcolor{comment}{// Get list of all effective Dm^2}
1226   vector<double> effDm;
1227 
1228   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1; i++)\{
1229     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=i+1; j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; j++)\{
1230       effDm.push\_back( 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV} * \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} * fabs(\hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[j] - 
      \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i]) );
1231     \}
1232   \}
1233 
1234   \textcolor{keywordtype}{int} numDm = effDm.size();
1235 
1236   \textcolor{comment}{// Set a number of sub-divisions to achieve "good" accuracy}
1237   \textcolor{comment}{// This needs to be studied better}
1238   \textcolor{keywordtype}{int} n\_div = ceil( 20 * pow(dLoE/LoE,0.8) );
1239   \textcolor{comment}{//int n\_div = 1;}
1240 
1241   \textcolor{comment}{// A vector to store sample points}
1242   vector<double> allSamples;
1243 
1244   \textcolor{comment}{// Loop over sub-divisions}
1245   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<n\_div; k++)\{
1246 
1247     \textcolor{comment}{// Define sub-division center and width}
1248     \textcolor{keywordtype}{double} bctr = LoE - dLoE/2 + (k+0.5)*dLoE/n\_div;
1249     \textcolor{keywordtype}{double} bwdt = dLoE/n\_div;
1250 
1251     \textcolor{comment}{// Make a list of indices sorted by Dm^2 value}
1252     vector<int> Idx(numDm, 0);
1253     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<numDm; i++) Idx[i] = i;
1254     sort(Idx.begin(), Idx.end(), \hyperlink{structOscProb_1_1IdxCompare}{IdxCompare}(effDm));
1255 
1256     \textcolor{comment}{// Make a vector of L/E sample values}
1257     \textcolor{comment}{// Initialized in the sub-division center}
1258     vector<double> samples;
1259     samples.push\_back(bctr);
1260 
1261     \textcolor{comment}{// Loop over all Dm^2 to average each frequency}
1262     \textcolor{comment}{// This will recursively sample points in smaller}
1263     \textcolor{comment}{// bins so that all relevant frequencies are used}
1264     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<numDm; i++)\{
1265 
1266       \textcolor{comment}{// Copy the list of sample L/E values}
1267       vector<double> prev = samples;
1268 
1269       \textcolor{comment}{// Redefine bin width to lie within full sub-division}
1270       \textcolor{keywordtype}{double} Width = 2*min(prev[0] - (bctr - bwdt/2), (bctr + bwdt/2) - prev[0]);
1271 
1272       \textcolor{comment}{// Compute oscillation argument sorted from lowest  to highest}
1273       \textcolor{keyword}{const} \textcolor{keywordtype}{double} arg = k1267 * effDm[Idx[i]] * Width;
1274 
1275       \textcolor{comment}{// Skip small oscillation values.}
1276       \textcolor{comment}{// If it's the last one, lower the tolerance}
1277       \textcolor{keywordflow}{if}(i < numDm-1)\{
1278         \textcolor{keywordflow}{if}(arg<0.9) \textcolor{keywordflow}{continue};
1279       \}
1280       \textcolor{keywordflow}{else}\{
1281         \textcolor{keywordflow}{if}(arg<0.1) \textcolor{keywordflow}{continue};
1282       \}
1283 
1284       \textcolor{comment}{// Reset samples to redefine them}
1285       samples.clear();
1286 
1287       \textcolor{comment}{// Loop over previous samples}
1288       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<int(prev.size()); j++)\{
1289 
1290         \textcolor{comment}{// Compute new sample points around old samples}
1291         \textcolor{comment}{// This is based on a oscillatory quadrature rule}
1292         \textcolor{keywordtype}{double} sample = (1/sqrt(3)) * (Width/2);
1293         \textcolor{keywordflow}{if}(arg!=0) sample = acos(sin(arg)/arg)/arg * (Width/2);
1294 
1295         \textcolor{comment}{// Add samples above and below center}
1296         samples.push\_back(prev[j]-sample);
1297         samples.push\_back(prev[j]+sample);
1298 
1299       \}
1300 
1301     \}\textcolor{comment}{// End of loop over Dm^2}
1302 
1303     \textcolor{comment}{// Add sub-division samples to the end of allSamples vector}
1304     allSamples.insert(allSamples.end(), samples.begin(), samples.end());
1305 
1306   \}\textcolor{comment}{// End of loop over sub-divisions}
1307 
1308   \textcolor{comment}{// Return all sample points}
1309   \textcolor{keywordflow}{return} allSamples;
1310 
1311 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}\label{classOscProb_1_1PMNS__Base_adf23b569112f9f9e0e592f01d79a5f3d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Initialize\+Vectors@{Initialize\+Vectors}}
\index{Initialize\+Vectors@{Initialize\+Vectors}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Initialize\+Vectors()}{InitializeVectors()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector sizes and initialize elements to zero. 

Definition at line 76 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
77 \{
78 
79   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}    = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
80   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
81   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta} = vector< vector<double> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},0));
82 
83   \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState} = vector<complex>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero});
84   \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}     = vector< vector<complex> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complex>(
      \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},\hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero}));
85 
86   \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval} = vector<double>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, 0);
87   \hyperlink{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}{fEvec} = vector< vector<complex> >(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, vector<complex>(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus},
      \hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero}));
88 
89 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}\label{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!P@{P}}
\index{P@{P}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{P()}{P()}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::P (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute oscillation probability of flavour flv from current state

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_aa81f47ea36207b90a5feb9849060032d}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 961 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
962 \{
963   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
964   \textcolor{keywordflow}{return} norm(\hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[flv]);
965 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}\label{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 981 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
982 \{
983 
984   \textcolor{keywordflow}{if}(flvi < 0 || flvi >= \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
985     cout << \textcolor{stringliteral}{"ERROR: Initial flavour not in range: 0 - "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 << endl;
986   \}
987   \textcolor{keywordflow}{if}(flvf < 0 || flvf >= \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
988     cout << \textcolor{stringliteral}{"ERROR: Final flavour not in range: 0 - "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 << endl;
989   \}
990 
991   \hyperlink{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}{ResetToFlavour}(flvi);
992 
993   \hyperlink{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}{Propagate}();
994 
995   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_a0dc4d45bc3d7e03b9abbf5b4e100cc22}{P}(flvf);
996 
997 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}\label{classOscProb_1_1PMNS__Base_aa3cee10639d5c0879ccb9e78d62128d3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1014 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy().


\begin{DoxyCode}
1015 \{
1016 
1017   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1018 
1019   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1020 
1021 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}\label{classOscProb_1_1PMNS__Base_a6e0a74508d9d6db7be02e242b8467563}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Prob@{Prob}}
\index{Prob@{Prob}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Prob()}{Prob()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily double P\+M\+N\+S\+\_\+\+Base\+::\+Prob (\begin{DoxyParamCaption}\item[{int}]{flvi,  }\item[{int}]{flvf,  }\item[{double}]{E,  }\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Compute the probability of flvi going to flvf for a given energy in GeV and distance in km in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost.

Don\textquotesingle{}t use this if you want to propagate over multiple path segments.

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flvi} & -\/ The neutrino starting flavour. \\
\hline
{\em flvf} & -\/ The neutrino final flavour. \\
\hline
{\em E} & -\/ The neutrino energy in GeV \\
\hline
{\em L} & -\/ The neutrino path length in km\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Neutrino oscillation probability 
\end{DoxyReturn}


Definition at line 1045 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length().


\begin{DoxyCode}
1046 \{
1047 
1048   \hyperlink{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}{SetEnergy}(E);
1049   \hyperlink{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}{SetLength}(L);
1050 
1051   \textcolor{keywordflow}{return} \hyperlink{classOscProb_1_1PMNS__Base_aec5c399b93261f1962a4b7dbbb44b973}{Prob}(flvi, flvf);
1052 
1053 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}\label{classOscProb_1_1PMNS__Base_a054e3a8b05b9a958b6fa416e4a835e3e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Propagate@{Propagate}}
\index{Propagate@{Propagate}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Propagate()}{Propagate()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Propagate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Propagate neutrino state through full path 

Definition at line 917 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
918 \{
919 
920   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<int(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size()); i++)\{
921 
922     \hyperlink{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}{PropagatePath}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i]);
923 
924   \}
925 
926 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}\label{classOscProb_1_1PMNS__Base_accb08503acc162188041d7a96a280462}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Propagate\+Path@{Propagate\+Path}}
\index{Propagate\+Path@{Propagate\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Propagate\+Path()}{PropagatePath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Propagate the current neutrino state through a given path 
\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_aa75341a3608bb12d7792a14e67ef2d5e}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 884 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate().


\begin{DoxyCode}
885 \{
886 
887   \textcolor{comment}{// Set the neutrino path}
888   \hyperlink{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}{SetCurPath}(p);
889 
890   \textcolor{comment}{// Solve for eigensystem}
891   \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{SolveHam}();
892 
893   \textcolor{comment}{// Store coefficients of propagation eigenstates}
894   vector<complex> nuComp(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}, \hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero});
895   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
896     nuComp[i] = 0;
897     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
898       nuComp[i] += \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[j] * conj(\hyperlink{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}{fEvec}[j][i]);
899     \}
900   \}
901 
902   \textcolor{comment}{// Propagate neutrino state}
903   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
904     \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[i] = 0;
905     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
906       \textcolor{keywordtype}{double} arg = \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[j] * \hyperlink{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}{kKm2eV} * p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length};
907       \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[i] +=  \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}(cos(arg), -sin(arg)) * nuComp[j] * 
      \hyperlink{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}{fEvec}[i][j];
908     \}
909   \}
910 
911 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}\label{classOscProb_1_1PMNS__Base_ac0d4bf8ff1318ef96d3dafa62e0cec25}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Reset\+To\+Flavour@{Reset\+To\+Flavour}}
\index{Reset\+To\+Flavour@{Reset\+To\+Flavour}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Reset\+To\+Flavour()}{ResetToFlavour()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour (\begin{DoxyParamCaption}\item[{int}]{flv }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Reset the neutrino state back to a pure flavour where it starts

Flavours are\+: 
\begin{DoxyPre}
  0 = nue, 1 = numu, 2 = nutau
  3 = sterile\_1, 4 = sterile\_2, etc.
\end{DoxyPre}
 
\begin{DoxyParams}{Parameters}
{\em flv} & -\/ The neutrino starting flavour. \\
\hline
\end{DoxyParams}


Reimplemented in \hyperlink{classOscProb_1_1PMNS__Deco_a393940f176614e3ffebeea40cfe78a62}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco}.



Definition at line 939 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::one, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::zero.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
940 \{
941   assert(flv>=0 && flv<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});
942   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}; ++i)\{
943     \textcolor{keywordflow}{if} (i==flv) \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[i] = \hyperlink{classOscProb_1_1PMNS__Base_ab64aab27448a5aca27565c991a9d173e}{one};
944     \textcolor{keywordflow}{else}        \hyperlink{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}{fNuState}[i] = \hyperlink{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}{zero};
945   \}
946 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}\label{classOscProb_1_1PMNS__Base_aae18afd69074211335f49ec40e6011b9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!RotateH@{RotateH}}
\index{RotateH@{RotateH}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Rotate\+H()}{RotateH()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+RotateH (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Rotate the Hamiltonian by the angle theta\+\_\+ij and phase delta\+\_\+ij.

The rotations assume all off-\/diagonal elements with i $>$ j are zero. This is correct if the order of rotations is chosen appropriately and it speeds up computation by skipping null terms


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of the rotation ij \\
\hline
\end{DoxyParams}


Definition at line 718 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms().


\begin{DoxyCode}
718                                   \{
719 
720   \textcolor{comment}{// Do nothing if angle is zero}
721   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]==0) \textcolor{keywordflow}{return};
722 
723   \textcolor{keywordtype}{double} fSinBuffer = sin(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
724   \textcolor{keywordtype}{double} fCosBuffer = cos(\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i][j]);
725 
726   \textcolor{keywordtype}{double}  fHmsBufferD;
727   \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} fHmsBufferC;
728 
729   \textcolor{comment}{// With Delta}
730   \textcolor{keywordflow}{if}(i+1<j)\{
731     \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} fExpBuffer = \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}(cos(\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]), -sin(
      \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i][j]));
732 
733     \textcolor{comment}{// General case}
734     \textcolor{keywordflow}{if}(i>0)\{
735       \textcolor{comment}{// Top columns}
736       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
737         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i];
738 
739         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i] *= fCosBuffer;
740         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] * fSinBuffer * conj(fExpBuffer);
741 
742         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] *= fCosBuffer;
743         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] -= fHmsBufferC * fSinBuffer * fExpBuffer;
744       \}
745 
746       \textcolor{comment}{// Middle row and column}
747       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
748         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j];
749 
750         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] *= fCosBuffer;
751         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] -= conj(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
752 
753         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][k] *= fCosBuffer;
754         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][k] += fSinBuffer * fExpBuffer * conj(fHmsBufferC);
755       \}
756 
757       \textcolor{comment}{// Nodes ij}
758       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i];
759       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j]);
760 
761       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
762       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] * conj(fExpBuffer));
763       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] * fSinBuffer;
764 
765       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
766       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
767       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] * conj(fExpBuffer));
768 
769       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] * conj(fExpBuffer)) * fSinBuffer * fExpBuffer;
770       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC) * fExpBuffer;
771 
772     \}
773     \textcolor{comment}{// First rotation on j (No top columns)}
774     \textcolor{keywordflow}{else}\{
775       \textcolor{comment}{// Middle rows and columns}
776       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=i+1; k<j; k++)\{
777         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] = -conj(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][k]) * fSinBuffer * fExpBuffer;
778 
779         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][k] *= fCosBuffer;
780       \}
781 
782       \textcolor{comment}{// Nodes ij}
783       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i]);
784 
785       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] = fSinBuffer * fCosBuffer * (\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] - fHmsBufferD) * fExpBuffer;
786 
787       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
788       fHms[i][i] += fSinBuffer * fHms[j][j] * fSinBuffer;
789 
790       fHms[j][j] *= fCosBuffer * fCosBuffer;
791       fHms[j][j] += fSinBuffer * fHmsBufferD * fSinBuffer;
792     \}
793 
794   \}
795   \textcolor{comment}{// Without Delta (No middle rows or columns: j = i+1)}
796   \textcolor{keywordflow}{else}\{
797     \textcolor{comment}{// General case}
798     \textcolor{keywordflow}{if}(i>0)\{
799       \textcolor{comment}{// Top columns}
800       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<i; k++)\{
801         fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i];
802 
803         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i] *= fCosBuffer;
804         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][i] += \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] * fSinBuffer;
805 
806         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] *= fCosBuffer;
807         \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[k][j] -= fHmsBufferC * fSinBuffer;
808       \}
809 
810       \textcolor{comment}{// Nodes ij}
811       fHmsBufferC = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i];
812       fHmsBufferD = real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j]);
813 
814       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] *= fCosBuffer * fCosBuffer;
815       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] += 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j]);
816       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i] += fSinBuffer * \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] * fSinBuffer;
817 
818       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] *= fCosBuffer * fCosBuffer;
819       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] += fSinBuffer * fHmsBufferC * fSinBuffer;
820       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j] -= 2 * fSinBuffer * fCosBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j]);
821 
822       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] -= 2 * fSinBuffer * real(\hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j]) * fSinBuffer;
823       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] += fSinBuffer * fCosBuffer * (fHmsBufferD - fHmsBufferC);
824 
825     \}
826     \textcolor{comment}{// First rotation (theta12)}
827     \textcolor{keywordflow}{else}\{
828 
829       \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j] = fSinBuffer * fCosBuffer * \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[j][j];
830 
831       fHms[i][i] = fSinBuffer * fHms[j][j] * fSinBuffer;
832 
833       fHms[j][j] *= fCosBuffer * fCosBuffer;
834 
835     \}
836   \}
837 
838 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}\label{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Angle@{Set\+Angle}}
\index{Set\+Angle@{Set\+Angle}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Angle()}{SetAngle()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{th }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mixing angle theta\+\_\+ij in radians.

Requires that i$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of theta\+\_\+ij \\
\hline
{\em th} & -\/ the value of theta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 532 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
533 \{
534 
535   \textcolor{keywordflow}{if}(i>j)\{
536     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
537     cout << \textcolor{stringliteral}{"         Setting reverse order (Theta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
538     \textcolor{keywordtype}{int} temp = i;
539     i = j;
540     j = temp;
541   \}
542   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
543     cout << \textcolor{stringliteral}{"ERROR: Theta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
544     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
545     \textcolor{keywordflow}{return};
546   \}
547 
548   \textcolor{comment}{// Check if value is actually changing}
549   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] == th);
550 
551   \hyperlink{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}{fTheta}[i-1][j-1] = th;
552 
553 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}\label{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{double}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set some single path attribute.

An auxiliary function to set individual attributes in a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The value of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 321 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Zo\+A().


\begin{DoxyCode}
321                                          \{
322 
323   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size() != 1)\{
324 
325     cout << \textcolor{stringliteral}{"Warning: Clearing path vector and starting new single path."} << endl;
326     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
327 
328     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
329 
330   \}
331 
332   \textcolor{keywordflow}{switch}(idx)\{
333     \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].length  = att; \textcolor{keywordflow}{break};
334     \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].density = att; \textcolor{keywordflow}{break};
335     \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].zoa     = att; \textcolor{keywordflow}{break};
336     \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0].layer   = att; \textcolor{keywordflow}{break};
337   \}
338 
339 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}\label{classOscProb_1_1PMNS__Base_aa001479b5f5828c3d16ed087f96ecbcc}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Att@{Set\+Att}}
\index{Set\+Att@{Set\+Att}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Att()}{SetAtt()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{att,  }\item[{int}]{idx }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set all values of a path attribute.

An auxiliary function to set individual attributes in a path sequence.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em att} & -\/ The values of the attribute \\
\hline
{\em idx} & -\/ The index of the attribute (0,1,2,3) = (L, Rho, Z/A, Layer) \\
\hline
\end{DoxyParams}


Definition at line 398 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
398                                                     \{
399 
400   \textcolor{comment}{// Get the sizes of the attribute and}
401   \textcolor{comment}{// path sequence vectors}
402   \textcolor{keywordtype}{int} nA = att.size();
403   \textcolor{keywordtype}{int} nP = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}.size();
404 
405   \textcolor{comment}{// If the vector sizes are equal, update this attribute}
406   \textcolor{keywordflow}{if}(nA == nP)\{
407 
408     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nP; i++)\{
409 
410       \textcolor{keywordflow}{switch}(idx)\{
411         \textcolor{keywordflow}{case} 0: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].length  = att[i]; \textcolor{keywordflow}{break};
412         \textcolor{keywordflow}{case} 1: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].density = att[i]; \textcolor{keywordflow}{break};
413         \textcolor{keywordflow}{case} 2: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].zoa     = att[i]; \textcolor{keywordflow}{break};
414         \textcolor{keywordflow}{case} 3: \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[i].layer   = att[i]; \textcolor{keywordflow}{break};
415       \}
416 
417     \}
418 
419   \}
420   \textcolor{comment}{// If the vector sizes differ, create a new path sequence}
421   \textcolor{comment}{// and set value for this attribute. Other attributes will}
422   \textcolor{comment}{// be taken from default single path.}
423   \textcolor{keywordflow}{else}\{
424 
425     cout << \textcolor{stringliteral}{"Warning: New vector size. Starting new path vector."} << endl;
426     cout << \textcolor{stringliteral}{"To avoid possible issues, use the SetPath function."} << endl;
427 
428     \textcolor{comment}{// Start a new standard path just}
429     \textcolor{comment}{// to set default values}
430     \hyperlink{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}{SetStdPath}();
431 
432     \textcolor{comment}{// Create a path segment with default values}
433     \hyperlink{structOscProb_1_1NuPath}{NuPath} p = \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}[0];
434 
435     \textcolor{comment}{// Clear the path sequence}
436     \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
437 
438     \textcolor{comment}{// Set this particular attribute's value}
439     \textcolor{comment}{// and add the path segment to the sequence}
440     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<nA; i++)\{
441 
442       \textcolor{keywordflow}{switch}(idx)\{
443         \textcolor{keywordflow}{case} 0: p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = att[i]; \textcolor{keywordflow}{break};
444         \textcolor{keywordflow}{case} 1: p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = att[i]; \textcolor{keywordflow}{break};
445         \textcolor{keywordflow}{case} 2: p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = att[i]; \textcolor{keywordflow}{break};
446         \textcolor{keywordflow}{case} 3: p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = att[i]; \textcolor{keywordflow}{break};
447       \}
448 
449       \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
450 
451     \}
452 
453   \}
454 
455 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}\label{classOscProb_1_1PMNS__Base_a986e6ebef09a7e2eb7fee16a4c2c834d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Cur\+Path@{Set\+Cur\+Path}}
\index{Set\+Cur\+Path@{Set\+Cur\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Cur\+Path()}{SetCurPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the path currentlyin use by the class.

This will be used to know what path to propagate through next.

It will also check if values are changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 210 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().


\begin{DoxyCode}
211 \{
212 
213   \textcolor{comment}{// Check if relevant value are actually changing}
214   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} == p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density});
215   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa} == p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa});
216 
217   \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath} = p;
218 
219 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}\label{classOscProb_1_1PMNS__Base_a4bef78cfcfc4e70b4ce79cdb8862c0a3}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Delta@{Set\+Delta}}
\index{Set\+Delta@{Set\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Delta()}{SetDelta()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{int}]{j,  }\item[{double}]{delta }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the CP phase delta\+\_\+ij in radians.

Requires that i+1$<$j. Will notify you if input is wrong. If i$>$j, will assume reverse order and swap i and j.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em i,j} & -\/ the indices of delta\+\_\+ij \\
\hline
{\em delta} & -\/ the value of delta\+\_\+ij \\
\hline
\end{DoxyParams}


Definition at line 598 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Mix().


\begin{DoxyCode}
599 \{
600 
601   \textcolor{keywordflow}{if}(i>j)\{
602     cout << \textcolor{stringliteral}{"Warning: First argument should be smaller than second argument"} << endl;
603     cout << \textcolor{stringliteral}{"         Setting reverse order (Delta"} << j << i << \textcolor{stringliteral}{"). "} << endl;
604     \textcolor{keywordtype}{int} temp = i;
605     i = j;
606     j = temp;
607   \}
608   \textcolor{keywordflow}{if}(i<1 || i>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}-1 || j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
609     cout << \textcolor{stringliteral}{"ERROR: Delta"} << i << j << \textcolor{stringliteral}{" not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
610     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
611     \textcolor{keywordflow}{return};
612   \}
613   \textcolor{keywordflow}{if}(i+1==j)\{
614     cout << \textcolor{stringliteral}{"Warning: Rotation "} << i << j << \textcolor{stringliteral}{" is real. Doing nothing."} << endl;
615     \textcolor{keywordflow}{return};
616   \}
617 
618   \textcolor{comment}{// Check if value is actually changing}
619   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] == delta);
620 
621   \hyperlink{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}{fDelta}[i-1][j-1] = delta;
622 
623 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}\label{classOscProb_1_1PMNS__Base_ac74206f349687da141392c81e2ba6b0d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{double}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path density.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 365 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
365                                     \{
366 
367   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
368 
369 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}\label{classOscProb_1_1PMNS__Base_a858221d5510fe732dc6a101fd305cda0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Density@{Set\+Density}}
\index{Set\+Density@{Set\+Density}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Density()}{SetDensity()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Density (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{rho }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path densities.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em rho} & -\/ The densities of the path segments in g/cm$^\wedge$3 \\
\hline
\end{DoxyParams}


Definition at line 481 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
481                                                \{
482 
483   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(rho, 1);
484 
485 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}\label{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Dm@{Set\+Dm}}
\index{Set\+Dm@{Set\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Dm()}{SetDm()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm (\begin{DoxyParamCaption}\item[{int}]{j,  }\item[{double}]{dm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the mass-\/splitting dm\+\_\+j1 = (m\+\_\+j$^\wedge$2 -\/ m\+\_\+1$^\wedge$2) in e\+V$^\wedge$2

Requires that j$>$1. Will notify you if input is wrong.

This will check if value is changing to keep track of whether the hamiltonian needs to be rebuilt.


\begin{DoxyParams}{Parameters}
{\em j} & -\/ the index of dm\+\_\+j1 \\
\hline
{\em dm} & -\/ the value of dm\+\_\+j1 \\
\hline
\end{DoxyParams}


Definition at line 670 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Delta\+Msqrs(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars().


\begin{DoxyCode}
671 \{
672 
673   \textcolor{keywordflow}{if}(j<2 || j>\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus})\{
674     cout << \textcolor{stringliteral}{"ERROR: Dm"} << j << \textcolor{stringliteral}{"1 not valid for "} << \hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};
675     cout << \textcolor{stringliteral}{" neutrinos. Doing nothing."} << endl;
676     \textcolor{keywordflow}{return};
677   \}
678 
679   \textcolor{comment}{// Check if value is actually changing}
680   \hyperlink{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}{fBuiltHms} *= (\hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] == dm);
681 
682   \hyperlink{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}{fDm}[j-1] = dm;
683 
684 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}\label{classOscProb_1_1PMNS__Base_a95b3b0d0cab5e6a54b5ef99587f837c0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Energy@{Set\+Energy}}
\index{Set\+Energy@{Set\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Energy()}{SetEnergy()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy (\begin{DoxyParamCaption}\item[{double}]{E }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set neutrino energy in GeV.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em E} & -\/ The neutrino energy in GeV \\
\hline
\end{DoxyParams}


Definition at line 150 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
151 \{
152 
153   \textcolor{comment}{// Check if value is actually changing}
154   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} == E);
155 
156   \hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy} = E;
157 
158 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}\label{classOscProb_1_1PMNS__Base_a717e0348cf762f3961854e332a9b52e0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}}
\index{Set\+Is\+Nu\+Bar@{Set\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Is\+Nu\+Bar()}{SetIsNuBar()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar (\begin{DoxyParamCaption}\item[{bool}]{is\+Nu\+Bar }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set anti-\/neutrino flag.

This will check if value is changing to keep track of whether the eigensystem needs to be recomputed.


\begin{DoxyParams}{Parameters}
{\em is\+Nu\+Bar} & -\/ Set to true for anti-\/neutrino and false for neutrino. \\
\hline
\end{DoxyParams}


Definition at line 169 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
170 \{
171 
172   \textcolor{comment}{// Check if value is actually changing}
173   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} *= (\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} == isNuBar);
174 
175   \hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar} = isNuBar;
176 
177 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}\label{classOscProb_1_1PMNS__Base_a904e580edf89fb98bf9a6397739b4ebe}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Layers@{Set\+Layers}}
\index{Set\+Layers@{Set\+Layers}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Layers()}{SetLayers()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Layers (\begin{DoxyParamCaption}\item[{std\+::vector$<$ int $>$}]{lay }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path layer indices.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em lay} & -\/ Indices to identify the layer types (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 511 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
511                                            \{
512 
513   vector<double> lay\_double(lay.begin(), lay.end());
514 
515   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(lay\_double, 3);
516 
517 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}\label{classOscProb_1_1PMNS__Base_a6241325b1bd28cafa556daaecbe4ed62}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{double}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set the length for a single path.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The length of the path segment in km \\
\hline
\end{DoxyParams}


Definition at line 350 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob().


\begin{DoxyCode}
350                                  \{
351 
352   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
353 
354 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}\label{classOscProb_1_1PMNS__Base_aa34a40a3b5abda0f252982d9ead3b520}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Length@{Set\+Length}}
\index{Set\+Length@{Set\+Length}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Length()}{SetLength()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Length (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{L }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path lengths.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em L} & -\/ The lengths of the path segments in km \\
\hline
\end{DoxyParams}


Definition at line 466 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
466                                             \{
467 
468   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(L, 0);
469 
470 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}\label{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em p} & -\/ A neutrino path segment \\
\hline
\end{DoxyParams}


Definition at line 285 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path().


\begin{DoxyCode}
285                                \{
286 
287   \hyperlink{classOscProb_1_1PMNS__Base_aefe521239031c418cfaaaa550a6e13bb}{ClearPath}();
288   \hyperlink{classOscProb_1_1PMNS__Base_a887dc9d4dc569ec0cdef3933b4c60efc}{AddPath}(p);
289 
290 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}\label{classOscProb_1_1PMNS__Base_a35b983270613072a3df58b574d80dbfd}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{double}]{length,  }\item[{double}]{density,  }\item[{double}]{zoa = {\ttfamily 0.5},  }\item[{int}]{layer = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set a single path defining attributes directly.

This destroys the current path sequence and creates a new first path.


\begin{DoxyParams}{Parameters}
{\em length} & -\/ The length of the path segment in km \\
\hline
{\em density} & -\/ The density of the path segment in g/cm$^\wedge$3 \\
\hline
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
{\em layer} & -\/ An index to identify the layer type (e.\+g. earth inner core) \\
\hline
\end{DoxyParams}


Definition at line 303 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().


\begin{DoxyCode}
303                                                                            \{
304 
305   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(\hyperlink{structOscProb_1_1NuPath}{NuPath}(length, density, zoa, layer));
306 
307 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}\label{classOscProb_1_1PMNS__Base_a637d19dd850b4246507796526622643c}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Path@{Set\+Path}}
\index{Set\+Path@{Set\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Path()}{SetPath()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path (\begin{DoxyParamCaption}\item[{std\+::vector$<$ \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} $>$}]{paths }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set vector of neutrino paths. 
\begin{DoxyParams}{Parameters}
{\em paths} & -\/ A sequence of neutrino paths \\
\hline
\end{DoxyParams}


Definition at line 236 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths.


\begin{DoxyCode}
236                                               \{
237 
238   \hyperlink{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}{fNuPaths}=paths;
239 
240 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}\label{classOscProb_1_1PMNS__Base_a4de96ac9b6d1e9b029ab877e57d211ad}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Std\+Pars@{Set\+Std\+Pars}}
\index{Set\+Std\+Pars@{Set\+Std\+Pars}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Std\+Pars()}{SetStdPars()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard oscillation parameters from P\+DG 2015.

For two neutrinos, Dm is set to the muon disappearance effective mass-\/splitting and mixing angle. 

Definition at line 98 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base().


\begin{DoxyCode}
99 \{
100 
101   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}>2)\{
102     \textcolor{comment}{// PDG values for 3 neutrinos}
103     \textcolor{comment}{// Also applicable for 3+N neutrinos}
104     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, asin(sqrt(0.304)));
105     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,3, asin(sqrt(0.0219)));
106     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(2,3, asin(sqrt(0.514)));
107     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 7.53e-5);
108     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(3, 2.52e-3);
109   \}
110   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus}==2)\{
111     \textcolor{comment}{// Effective muon disappearance values}
112     \textcolor{comment}{// for two-flavour approximation}
113     \hyperlink{classOscProb_1_1PMNS__Base_ace7875cf6d3bec161a2b7ed2690aec34}{SetAngle}(1,2, 0.788);
114     \hyperlink{classOscProb_1_1PMNS__Base_a492243b22fb1b783cd2943f507cff970}{SetDm}(2, 2.47e-3);
115   \}
116 
117 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}\label{classOscProb_1_1PMNS__Base_add6533a9fc9acdfc7ae258b62570d78d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+Std\+Path@{Set\+Std\+Path}}
\index{Set\+Std\+Path@{Set\+Std\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Std\+Path()}{SetStdPath()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Path (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set standard single path.

Length is 1000 km, so $\sim$2 GeV peak energy.

Density is approximate from C\+R\+U\+S\+T2.\+0 ($\sim$2.8 g/cm$^\wedge$3). Z/A is set to a round 0.\+5. 

Definition at line 128 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+Nu\+Path\+::layer, Osc\+Prob\+::\+Nu\+Path\+::length, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path(), and Osc\+Prob\+::\+Nu\+Path\+::zoa.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+P\+M\+N\+S\+\_\+\+Deco(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
128                           \{
129 
130   \hyperlink{structOscProb_1_1NuPath}{NuPath} p;
131 
132   p.\hyperlink{structOscProb_1_1NuPath_af22660894b6e25cf835500381b155557}{length}  = 1000; \textcolor{comment}{// 1000 km default}
133   p.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density} = 2.8;  \textcolor{comment}{// Crust density}
134   p.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa}     = 0.5;  \textcolor{comment}{// Crust Z/A}
135   p.\hyperlink{structOscProb_1_1NuPath_a442b160899e554ad1d800989510d5309}{layer}   = 0;    \textcolor{comment}{// Single layer}
136 
137   \hyperlink{classOscProb_1_1PMNS__Base_ac3b644fd0a56347d304ceca4ae9d8875}{SetPath}(p);
138 
139 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}\label{classOscProb_1_1PMNS__Base_a1bf3ea8fd2507fd2fd82d7410ff8f578}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{double}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set single path Z/A.

If the path sequence is not a single path, a new single path will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segment \\
\hline
\end{DoxyParams}


Definition at line 380 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
380                                 \{
381 
382   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
383 
384 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}\label{classOscProb_1_1PMNS__Base_a8495f8a320e1a21965e6a64aec92ad2a}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Set\+ZoA@{Set\+ZoA}}
\index{Set\+ZoA@{Set\+ZoA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Set\+Zo\+A()}{SetZoA()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Base\+::\+Set\+ZoA (\begin{DoxyParamCaption}\item[{std\+::vector$<$ double $>$}]{zoa }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}

Set multiple path Z/A values.

If the path sequence is of a different size, a new path sequence will be created and the previous sequence will be lost. Use with care.


\begin{DoxyParams}{Parameters}
{\em zoa} & -\/ The effective Z/A of the path segments \\
\hline
\end{DoxyParams}


Definition at line 496 of file P\+M\+N\+S\+\_\+\+Base.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att().


\begin{DoxyCode}
496                                            \{
497 
498   \hyperlink{classOscProb_1_1PMNS__Base_aba565962a440d14bee7a2a96d2eca2c5}{SetAtt}(zoa, 2);
499 
500 \}
\end{DoxyCode}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_af60f89862d0fe333c62d6f87ecfd89f8}\label{classOscProb_1_1PMNS__Sterile_af60f89862d0fe333c62d6f87ecfd89f8}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!Solve\+Ham@{Solve\+Ham}}
\index{Solve\+Ham@{Solve\+Ham}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{Solve\+Ham()}{SolveHam()}}
{\footnotesize\ttfamily void P\+M\+N\+S\+\_\+\+Sterile\+::\+Solve\+Ham (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}

Build and solve the full Hamiltonian for eigenvectors and eigenvalues.

This uses G\+SL to solve the eigensystem.

Here we divide the mass squared matrix Hms by the 2E to obtain the vacuum Hamiltonian in eV. Then, the matter potential is added to the electron and sterile components.

The matter potential is implemented as in ar\+Xiv\+:hep-\/ph/0606054v3 (eq. 3.\+15). 

Implements \hyperlink{classOscProb_1_1PMNS__Base_a91f065cb9e910e0095e41462b4420b01}{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base}.



Definition at line 78 of file P\+M\+N\+S\+\_\+\+Sterile.\+cxx.



References Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+Nu\+Path\+::density, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval, f\+Eval\+G\+SL, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec, f\+Evec\+G\+SL, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path, H\+\_\+\+G\+SL, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+Gf, Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::k\+K2, W\+\_\+\+G\+SL, and Osc\+Prob\+::\+Nu\+Path\+::zoa.


\begin{DoxyCode}
79 \{
80 
81   \textcolor{comment}{// Build Hamiltonian}
82   \hyperlink{classOscProb_1_1PMNS__Base_ad0faf5eae755afb1baa1fcd5ffebad41}{BuildHms}();
83 
84   \textcolor{comment}{// Check if anything changed}
85   \textcolor{keywordflow}{if}(\hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES}) \textcolor{keywordflow}{return};
86 
87   \textcolor{keywordtype}{double} rho = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_a54ddd451db69bc54434de3cf18a117ca}{density};
88   \textcolor{keywordtype}{double} zoa = \hyperlink{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}{fPath}.\hyperlink{structOscProb_1_1NuPath_af3213f3691ba83c6bc05f4a3490f6b31}{zoa};
89 
90   \textcolor{keywordtype}{double} lv = 2 * \hyperlink{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}{kGeV2eV}*\hyperlink{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}{fEnergy};                 \textcolor{comment}{// 2E in eV }
91   \textcolor{keywordtype}{double} kr2GNe = \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{kK2}*M\_SQRT2*\hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{kGf} * rho*zoa;       \textcolor{comment}{// Electron matter potential in eV}
92   \textcolor{keywordtype}{double} kr2GNn = \hyperlink{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}{kK2}*M\_SQRT2*\hyperlink{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}{kGf} * rho*(1-zoa)/2; \textcolor{comment}{// Neutron matter potential in eV}
93 
94   \textcolor{comment}{// Finish building Hamiltonian in matter with dimension of eV}
95   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0;i<size\_t(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});i++)\{
96     \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex} buf = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][i]/lv;
97     *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, i, i) = gsl\_complex\_rect(real(buf),0);
98     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j=i+1;j<size\_t(\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus});j++)\{
99       buf = \hyperlink{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}{fHms}[i][j]/lv;
100       \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, j, i) = gsl\_complex\_rect(real(buf),-imag(
      buf));
101       \textcolor{keywordflow}{else}          *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, j, i) = gsl\_complex\_rect(real(buf), imag(buf));
102     \}
103     \textcolor{keywordflow}{if}(i>2)\{
104       \textcolor{comment}{// Subtract NC coherent forward scattering from sterile neutrinos. See arXiv:hep-ph/0606054v3, eq.
       3.15, for example. }
105       \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, i, i) = gsl\_complex\_add\_real(
      gsl\_matrix\_complex\_get(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL},i,i) ,  kr2GNn);
106       \textcolor{keywordflow}{else}          *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, i, i) = gsl\_complex\_add\_real(gsl\_matrix\_complex\_get
      (\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL},i,i) , -kr2GNn);;
107     \}
108   \}
109   \textcolor{comment}{// Add nue CC coherent forward scattering from sterile neutrinos. }
110   \textcolor{keywordflow}{if}(!\hyperlink{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}{fIsNuBar}) *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, 0, 0) = gsl\_complex\_add\_real(
      gsl\_matrix\_complex\_get(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL},0,0) ,  kr2GNe);
111   \textcolor{keywordflow}{else}          *gsl\_matrix\_complex\_ptr(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, 0, 0) = gsl\_complex\_add\_real(gsl\_matrix\_complex\_get(
      \hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL},0,0) , -kr2GNe);
112 
113   \textcolor{comment}{// Solve Hamiltonian for eigensystem}
114   gsl\_eigen\_hermv(\hyperlink{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}{H\_GSL}, \hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL}, \hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL}, \hyperlink{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}{W\_GSL});
115 
116   \textcolor{comment}{// Fill fEval and fEvec vectors from GSL objects}
117   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};i++)\{
118     \hyperlink{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}{fEval}[i] = gsl\_vector\_get(\hyperlink{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}{fEvalGSL},i);
119     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<\hyperlink{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}{fNumNus};j++)\{
120       gsl\_complex buf = gsl\_matrix\_complex\_get(\hyperlink{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}{fEvecGSL},i,j);
121       \hyperlink{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}{fEvec}[i][j] = \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}( GSL\_REAL(buf), GSL\_IMAG(buf) );
122     \}
123   \}
124   
125   \hyperlink{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}{fGotES} = \textcolor{keyword}{true};
126   
127 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}\label{classOscProb_1_1PMNS__Base_a9ac3cadeac8db1b90f3152f476244780}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Built\+Hms@{f\+Built\+Hms}}
\index{f\+Built\+Hms@{f\+Built\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Built\+Hms}{fBuiltHms}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Built\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 174 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}\label{classOscProb_1_1PMNS__Base_ab2a5fa40e689b221c8a7d2c17213810d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Delta@{f\+Delta}}
\index{f\+Delta@{f\+Delta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Delta}{fDelta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Delta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 160 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}\label{classOscProb_1_1PMNS__Base_a406a31c3b5d620e5a0cace5b411f9f70}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Dm@{f\+Dm}}
\index{f\+Dm@{f\+Dm}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Dm}{fDm}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Dm\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 158 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}\label{classOscProb_1_1PMNS__Base_a2800af6d436972f3e900867790c046b0}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Energy@{f\+Energy}}
\index{f\+Energy@{f\+Energy}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Energy}{fEnergy}}
{\footnotesize\ttfamily double Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Energy\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 168 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}\label{classOscProb_1_1PMNS__Base_a6319c34d7decbb9d7d6da279c06e8c2d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Eval@{f\+Eval}}
\index{f\+Eval@{f\+Eval}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Eval}{fEval}}
{\footnotesize\ttfamily std\+::vector$<$double$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Eval\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 165 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}\label{classOscProb_1_1PMNS__Sterile_abdcb0a144aadef0239dfb36ed4ed0297}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Eval\+G\+SL@{f\+Eval\+G\+SL}}
\index{f\+Eval\+G\+SL@{f\+Eval\+G\+SL}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Eval\+G\+SL}{fEvalGSL}}
{\footnotesize\ttfamily gsl\+\_\+vector$\ast$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::f\+Eval\+G\+SL\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 37 of file P\+M\+N\+S\+\_\+\+Sterile.\+h.



Referenced by P\+M\+N\+S\+\_\+\+Sterile(), Solve\+Ham(), and $\sim$\+P\+M\+N\+S\+\_\+\+Sterile().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}\label{classOscProb_1_1PMNS__Base_a093e7bd31d4ef52ed52df414e12c1d17}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Evec@{f\+Evec}}
\index{f\+Evec@{f\+Evec}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Evec}{fEvec}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Evec\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 166 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}\label{classOscProb_1_1PMNS__Sterile_a8ab71bc7de328eb6ba855904f365fb1d}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Evec\+G\+SL@{f\+Evec\+G\+SL}}
\index{f\+Evec\+G\+SL@{f\+Evec\+G\+SL}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Evec\+G\+SL}{fEvecGSL}}
{\footnotesize\ttfamily gsl\+\_\+matrix\+\_\+complex$\ast$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::f\+Evec\+G\+SL\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 38 of file P\+M\+N\+S\+\_\+\+Sterile.\+h.



Referenced by P\+M\+N\+S\+\_\+\+Sterile(), Solve\+Ham(), and $\sim$\+P\+M\+N\+S\+\_\+\+Sterile().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}\label{classOscProb_1_1PMNS__Base_a6dc5cd010d2d70b2324745b4e53e9839}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Got\+ES@{f\+Got\+ES}}
\index{f\+Got\+ES@{f\+Got\+ES}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Got\+ES}{fGotES}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Got\+ES\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 175 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Deco\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Energy(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Solve\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}\label{classOscProb_1_1PMNS__Base_adf5901166216e8c7a5cff2092952f473}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Hms@{f\+Hms}}
\index{f\+Hms@{f\+Hms}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Hms}{fHms}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$\hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Hms\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 163 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}\label{classOscProb_1_1PMNS__Base_a0ebaeaefab36a3ff381c6293faedfdd6}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}}
\index{f\+Is\+Nu\+Bar@{f\+Is\+Nu\+Bar}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Is\+Nu\+Bar}{fIsNuBar}}
{\footnotesize\ttfamily bool Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Is\+Nu\+Bar\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 169 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Is\+Nu\+Bar(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}\label{classOscProb_1_1PMNS__Base_a24bb74bed63569dfe88b18fa6a08060e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Num\+Nus@{f\+Num\+Nus}}
\index{f\+Num\+Nus@{f\+Num\+Nus}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Num\+Nus}{fNumNus}}
{\footnotesize\ttfamily int Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Num\+Nus\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 156 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Build\+Hms(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Get\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P\+M\+N\+S\+\_\+\+Base(), P\+M\+N\+S\+\_\+\+Sterile(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Delta(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Dm(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Set\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Set\+Gamma(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Std\+Pars(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}\label{classOscProb_1_1PMNS__Base_a69db9d57e12fc7cbe0431bc6c18fac93}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Nu\+Paths@{f\+Nu\+Paths}}
\index{f\+Nu\+Paths@{f\+Nu\+Paths}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Nu\+Paths}{fNuPaths}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+Paths\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 171 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Add\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Clear\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Att(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}\label{classOscProb_1_1PMNS__Base_ad38a7107c3ab393591fd5ba21658300b}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Nu\+State@{f\+Nu\+State}}
\index{f\+Nu\+State@{f\+Nu\+State}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Nu\+State}{fNuState}}
{\footnotesize\ttfamily std\+::vector$<$\hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}$>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Nu\+State\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 162 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+P(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}\label{classOscProb_1_1PMNS__Base_a849437aa8891fe042e86886ce8f81c6e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Path@{f\+Path}}
\index{f\+Path@{f\+Path}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Path}{fPath}}
{\footnotesize\ttfamily \hyperlink{structOscProb_1_1NuPath}{Osc\+Prob\+::\+Nu\+Path} Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Path\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 172 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Avg\+Prob\+Lo\+E(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Cur\+Path(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}\label{classOscProb_1_1PMNS__Base_a1976887cd658dd86b2336c181f1470b4}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!f\+Theta@{f\+Theta}}
\index{f\+Theta@{f\+Theta}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{f\+Theta}{fTheta}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::vector$<$double$>$ $>$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::f\+Theta\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 159 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Angle(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Rotate\+H(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Set\+Angle(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}\label{classOscProb_1_1PMNS__Sterile_aeff790051925a3135b7529ced67e81ab}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!H\+\_\+\+G\+SL@{H\+\_\+\+G\+SL}}
\index{H\+\_\+\+G\+SL@{H\+\_\+\+G\+SL}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{H\+\_\+\+G\+SL}{H\_GSL}}
{\footnotesize\ttfamily gsl\+\_\+matrix\+\_\+complex$\ast$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+H\+\_\+\+G\+SL\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 39 of file P\+M\+N\+S\+\_\+\+Sterile.\+h.



Referenced by P\+M\+N\+S\+\_\+\+Sterile(), Solve\+Ham(), and $\sim$\+P\+M\+N\+S\+\_\+\+Sterile().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}\label{classOscProb_1_1PMNS__Base_ad36a0a6bf58d6ec093d3947784bd89e9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!k\+Ge\+V2eV@{k\+Ge\+V2eV}}
\index{k\+Ge\+V2eV@{k\+Ge\+V2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{k\+Ge\+V2eV}{kGeV2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Ge\+V2eV = 1.\+0e+09\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 116 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Set\+Vacuum\+Eigensystem(), Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}\label{classOscProb_1_1PMNS__Base_a7f26a3456128234b2ae6cc9141a6532f}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!k\+Gf@{k\+Gf}}
\index{k\+Gf@{k\+Gf}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{k\+Gf}{kGf}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Gf = 1.\+1663787e-\/05\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 119 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}\label{classOscProb_1_1PMNS__Base_a326fc5016d7dd7ce05682c06cdcb6d94}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!k\+K2@{k\+K2}}
\index{k\+K2@{k\+K2}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{k\+K2}{kK2}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+K2 = 1e-\/3 $\ast$ k\+N\+A / pow(k\+Km2e\+V,3)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 115 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Solve\+Ham(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Fast\+::\+Update\+Ham(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Update\+Ham().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}\label{classOscProb_1_1PMNS__Base_a382ddd7b76ca89b43f22614a2ea7327b}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!k\+Km2eV@{k\+Km2eV}}
\index{k\+Km2eV@{k\+Km2eV}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{k\+Km2eV}{kKm2eV}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+Km2eV = 1.\+0 / 1.\+973269788e-\/10\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 114 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Get\+Sample\+Points(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Propagate\+Path(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}\label{classOscProb_1_1PMNS__Base_a69355e770b89e99437c2b8a66e48eeb9}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!k\+NA@{k\+NA}}
\index{k\+NA@{k\+NA}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{k\+NA}{kNA}}
{\footnotesize\ttfamily const double P\+M\+N\+S\+\_\+\+Base\+::k\+NA = 6.\+022140857e23\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 117 of file P\+M\+N\+S\+\_\+\+Base.\+h.

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_ab64aab27448a5aca27565c991a9d173e}\label{classOscProb_1_1PMNS__Base_ab64aab27448a5aca27565c991a9d173e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!one@{one}}
\index{one@{one}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{one}{one}}
{\footnotesize\ttfamily const \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}$<$ double $>$ P\+M\+N\+S\+\_\+\+Base\+::one\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 111 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}\label{classOscProb_1_1PMNS__Sterile_a4e8aed8fd29297e4833488572c9a4eb1}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!W\+\_\+\+G\+SL@{W\+\_\+\+G\+SL}}
\index{W\+\_\+\+G\+SL@{W\+\_\+\+G\+SL}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{W\+\_\+\+G\+SL}{W\_GSL}}
{\footnotesize\ttfamily gsl\+\_\+eigen\+\_\+hermv\+\_\+workspace$\ast$ Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile\+::\+W\+\_\+\+G\+SL\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 40 of file P\+M\+N\+S\+\_\+\+Sterile.\+h.



Referenced by P\+M\+N\+S\+\_\+\+Sterile(), Solve\+Ham(), and $\sim$\+P\+M\+N\+S\+\_\+\+Sterile().

\mbox{\Hypertarget{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}\label{classOscProb_1_1PMNS__Base_a5c31ed4593cf95feb36fb80c1850d25e}} 
\index{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}!zero@{zero}}
\index{zero@{zero}!Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile@{Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Sterile}}
\subsubsection{\texorpdfstring{zero}{zero}}
{\footnotesize\ttfamily const \hyperlink{classOscProb_1_1PMNS__Base_ae86ec4718808ce9d02e5f5b4226714ab}{complex}$<$ double $>$ P\+M\+N\+S\+\_\+\+Base\+::zero\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}, {\ttfamily [inherited]}}



Definition at line 110 of file P\+M\+N\+S\+\_\+\+Base.\+h.



Referenced by Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+N\+S\+I\+::\+Get\+Eps(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Initialize\+Vectors(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Propagate\+Path(), Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Deco\+::\+Reset\+To\+Flavour(), and Osc\+Prob\+::\+P\+M\+N\+S\+\_\+\+Base\+::\+Reset\+To\+Flavour().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__Sterile_8h}{P\+M\+N\+S\+\_\+\+Sterile.\+h}\item 
/home/jcoelho/\+Osc\+Prob\+Git/\hyperlink{PMNS__Sterile_8cxx}{P\+M\+N\+S\+\_\+\+Sterile.\+cxx}\end{DoxyCompactItemize}
